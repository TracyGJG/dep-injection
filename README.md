# dep-injection

Implementation of a [Dependency Injection (DI)](https://www.oreilly.com/library/view/dependency-injection-principles/9781617294730/) mechanism to support the [Dependency Inversion](https://www.oreilly.com/library/view/mastering-javascript-object-oriented/9781785889103/ch11s06.html) principle.

This module exposes a single default export DependencyRegistry, which is a factory function to create a mechanism for managing internal dependencies.

The DependencyRegistry function employs the [Revealing Module Pattern](https://www.oreilly.com/library/view/learning-javascript-design/9781449334840/ch09s03.html) to expose four methods for manipulating dependencies. Internally the function maintains two maps, one for dependency constructors and the other for actual dependency instances. Dependency constructors can be either JS Classes or [factory function](https://www.oreilly.com/library/view/composing-software/9781836644637/chap16.xhtml).

The revealed methods include calls to register an instantiator (class or factory function), obtain and instance (named or singlton), release a named instance and clear the mechanism down prior to program termination.

---

## DependencyRegistry(...registrations)

### Parameters

- registrations:

### Return

An object exposing the following four methods.

## register(instantiator, instArgs)

### Parameters

- instantiator: An instantiator to be used to create new objects, either through a new class or factory function execution.
- instArgs: An array of arguments to be used when instantiating the singleton object. The inclusion of this array, even when empty, indicates the instantiator is to be used to create a singleton.

This method can be used ad-hoc but is most often used to register instantiators and create singleton objects when the registry is first called.

### Exceptions

- ReferenceError: An instantiator has already been registered for the given instance name.

### Return

None.

## create(instantiator, instRef, ...instArgs)

### Parameters

- instantiator:
- instRef:
- instArgs: A list of arguments to be used when instantiating the object.

### Exceptions

- ReferenceError: No instantiator registered for the given instance reference.
- ReferenceError: No instantiance found for singleton for the given instance reference.

### Return

An object instance generated by executing the instantiator (factory function or instantiation of a class.)

## remove(instRef)

Releases the specified instance from the DI mechanism. Not applicable to Singleton instances.

### Parameters

- instRef: Reference to an instance that is to be released from the DI mechanism.

### Exceptions

- ReferenceError: No instantiator registered as the given instance reference.

### Return

None.

## deregister()

Releases all instatiators and instances retained by the DI mechanism.

### Parameters

None.

### Return

None.

---
